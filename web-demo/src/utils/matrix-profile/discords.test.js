import calculateDiscords from './discords';

const data = [
  ['a-0', 1.174195, 'a-48'],
  ['a-1', 1.1239, 'a-49'],
  ['a-2', 1.10584, 'a-50'],
  ['a-3', 1.103377, 'a-51'],
  ['a-4', 1.108958, 'a-52'],
  ['a-5', 1.84453, 'a-52'],
  ['a-6', 3.205378, 'a-52'],
  ['a-7', 4.498753, 'a-52'],
  ['a-8', 5.678745, 'a-52'],
  ['a-9', 6.701962, 'a-52'],
  ['a-10', 7.53907, 'a-52'],
  ['a-11', 8.284374, 'a-52'],
  ['a-12', 8.987782, 'a-52'],
  ['a-13', 9.669184, 'a-52'],
  ['a-14', 10.267778, 'a-52'],
  ['a-15', 10.765433, 'a-52'],
  ['a-16', 10.825505, 'a-40'],
  ['a-17', 10.815446, 'a-41'],
  ['a-18', 10.839062, 'a-42'],
  ['a-19', 10.858024, 'a-42'],
  ['a-20', 10.89819, 'a-43'],
  ['a-21', 10.933827, 'a-45'],
  ['a-22', 10.943706, 'a-45'],
  ['a-23', 10.958406, 'a-46'],
  ['a-24', 10.964709, 'a-48'],
  ['a-25', 10.968919, 'a-49'],
  ['a-26', 10.969575, 'a-50'],
  ['a-27', 10.97452, 'a-51'],
  ['a-28', 10.966324, 'a-52'],
  ['a-29', 10.962793, 'a-52'],
  ['a-30', 10.941929, 'a-6'],
  ['a-31', 10.911301, 'a-7'],
  ['a-32', 10.867833, 'a-8'],
  ['a-33', 10.831467, 'a-9'],
  ['a-34', 10.806081, 'a-10'],
  ['a-35', 10.811973, 'a-11'],
  ['a-36', 10.855399, 'a-12'],
  ['a-37', 10.861578, 'a-13'],
  ['a-38', 10.658994, 'a-0'],
  ['a-39', 10.072165, 'a-0'],
  ['a-40', 9.410629, 'a-0'],
  ['a-41', 8.7126, 'a-0'],
  ['a-42', 7.986033, 'a-0'],
  ['a-43', 7.141138, 'a-0'],
  ['a-44', 6.098842, 'a-0'],
  ['a-45', 4.903057, 'a-0'],
  ['a-46', 3.537959, 'a-0'],
  ['a-47', 2.065723, 'a-0'],
  ['a-48', 1.174195, 'a-0'],
  ['a-49', 1.1239, 'a-1'],
  ['a-50', 1.10584, 'a-2'],
  ['a-51', 1.103377, 'a-3'],
  ['a-52', 1.108958, 'a-4'],
];

const dates = new Map();

data.forEach((x, i) => dates.set(x[0], i));

const matrixProfile = {
  windowSize: 48,
  length: data.length,
  data,
  dates,
};

it('should find the correct discords', () => {
  const discords = calculateDiscords(matrixProfile, 24);

  expect(discords).toEqual(['a-27', 'a-0', 'a-52']);
});

it('should find the correct discords with a filter', () => {
  const discords = calculateDiscords(matrixProfile, 24, 3, (item) => {
    return item[0] !== 'a-27';
  });

  expect(discords).toEqual(['a-26', 'a-0', 'a-52']);
});
